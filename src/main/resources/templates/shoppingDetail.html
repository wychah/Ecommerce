<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>满意网-综合网购首选-正品低价、品质保证、配送即使、轻松购物、包您满意！</title>
    <!--icon字体图标-->
    <!--<link rel="shortcut icon" href="image/H6@QR(8]_TR5Z~FGIR$_WI8.png" type="image/x-icon"/>-->
    <!--初始化css-->
    <link rel="stylesheet" href="css/normalize.css" type="text/css">
    <!--公共的css:头部和底部-->
    <link rel="stylesheet" href="css/base.css" type="text/css">
    <!--商品列表页的css-->
    <link rel="stylesheet" href="css/shoppingDetail.css" type="text/css">
    <!--字体图标css-->
    <link rel="stylesheet" type="text/css" href="font/download/font_942gj5vp4fp/iconfont.css">
    <link rel="stylesheet" href="font/download/font_90ljwep9b4l/iconfont.css">
    <link rel="stylesheet" href="font/download (2)/font_pzp01tyw83/iconfont.css">
</head>
<body>
<!--快捷导航模块开始-->
<div class="shortcut">
    <div class="w" style="display: none;">
        <ul class="fl">
            <li><a href="http://localhost:8080/login">请登录</a></li>
            <li class="spacer">|</li>
            <li><a href="http://localhost:8080/register">注册</a></li>
            <li class="spacer">|</li>
            <li>
                <a href="#" id="wechartLogion">
                    <span></span>
                    微信登录
                </a>
            </li>
        </ul>
        <ul class="fr">
            <li id="phoneApp">
                <a href="#">
                    <span></span>
                    手机版
                </a>
                <div class="phoneApp">
                    <img src="image/shoujierweima.png" alt="">
                    <h4>查看手机网站</h4>
                </div>
                <div class="trangle1"></div>
            </li>
            <li class="spacer">|</li>
            <li>
                <a href="">
                    <span></span>
                    收藏本站
                </a>
            </li>
            <li class="spacer">|</li>
            <li><a href="">我的资料</a></li>
            <li class="spacer">|</li>
            <li><a href="">我的订单</a></li>
            <li class="spacer">|</li>
            <li>
                <a href="">
                    <span></span>
                    购物车
                    <number>(0)</number>
                </a>
            </li>
        </ul>
    </div>
    <div class="w" style="display: block;">
        <ul class="fl">
            <li class="userAccount"></li>
            <li class="spacer">|</li>
            <li><a href="#" class="loginOut">退出</a></li>
        </ul>
        <ul class="fr">
            <li id="phoneAppAfter">
                <a href="#">
                    <span></span>
                    手机版
                </a>
                <div class="phoneApp">
                    <img src="image/shoujierweima.png" alt="">
                    <h4>查看手机网站</h4>
                </div>
                <div class="trangle1"></div>
            </li>
            <li class="spacer">|</li>
            <li>
                <a href="">
                    <span></span>
                    收藏本站
                </a>
            </li>
            <li class="spacer">|</li>
            <li><a href="#">我的资料</a></li>
            <li class="spacer">|</li>
            <li><a href="">我的订单</a></li>
            <li class="spacer">|</li>
            <li>
                <a href="">
                    <span></span>
                    购物车
                </a>
            </li>
        </ul>
    </div>
</div>
<!--快捷导航模块结束-->
<!--顶部模块开始-->
<div class="header">
    <div class="w">
        <div class="text">
            E-commerce Platform
            <span>Design</span>
        </div>
        <div class="hotwords">
            <div class="itemCenter"><a href="http://localhost:8080">首页</a></div>
            <div class="itemCenter"><a href="http://localhost:8080/discount">优惠抢购</a></div>
            <div class="itemCenter"><a href="http://localhost:8080/secondhand">新品二手</a></div>
            <div class="itemCenter"><a href="http://localhost:8080/appliance">二手电器城</a></div>
            <div class="itemCenter"><a href="http://localhost:8080/member">会员购</a></div>
        </div>
    </div>
</div>
<!--顶部模块结束-->
<!--右侧工具栏开始-->
<div class="rightBar" style="display: none;">
    <i class="message iconfont icon-zhanghao">
        <div class="slogans">我的资料
            <span class="trangle"></span>
        </div>
        <div class="landingBoox">
            <span class="trangle"></span>
            <div class="logintitle">用户登录</div>
            <input type="text" name="userName" placeholder="用户名">
            <input type="text" name="password" placeholder="密码">
            <div class="loginBtn">登录</div>
            <div class="registerQuick"><a href="http://localhost:8080/register">免费注册></a></div>
        </div>
    </i>
    <i class="collection iconfont icon-shoucang-copy">
        <div class="slogans">我的收藏
            <span class="trangle"></span>
        </div>
        <div class="landingBoox">
            <span class="trangle"></span>
            <div class="logintitle">用户登录</div>
            <input type="text" name="userName" placeholder="用户名">
            <input type="text" name="password" placeholder="密码">
            <div class="loginBtn">登录</div>
            <div class="registerQuick"><a href="register.html">免费注册></a></div>
        </div>
    </i>
    <i class="shoppingCar iconfont icon-icon1">
        <div></div>
        <h1>购物车</h1>
        <span>0</span>
        <div class="landingBoox">
            <span class="trangle"></span>
            <div class="logintitle">用户登录</div>
            <input type="text" name="userName" placeholder="用户名">
            <input type="text" name="password" placeholder="密码">
            <div class="loginBtn">登录</div>
            <div class="registerQuick"><a href="register.html">免费注册></a></div>
        </div>
    </i>
    <i class="leaveMessage iconfont icon-liuyan">
        <div class="slogans">留言
            <span class="trangle"></span>
        </div>
    </i>
    <i class="erweima iconfont icon-erweima"></i>
    <i class="toTop iconfont icon-fanhuidingbu" id="toTop">
        <div class="slogans">回到顶部
            <span class="trangle"></span>
        </div>
    </i>
</div>
<div class="afterLogin" style="display: block;">
    <div class="fk-rbar-tabs">
        <i class="message iconfont icon-zhanghao">
            <div class="slogans">我的资料
                <span class="trangle"></span>
            </div>
        </i>
        <i class="collection iconfont icon-shoucang-copy">
            <div class="slogans">我的收藏
                <span class="trangle"></span>
            </div>
        </i>
        <i class="shoppingCar iconfont icon-icon1">
            <div></div>
            <h1>购物车</h1>
            <span>0</span>
        </i>
        <i class="leaveMessage iconfont icon-liuyan">
            <div class="slogans">留言
                <span class="trangle"></span>
            </div>
        </i>
        <i class="erweima iconfont icon-erweima"></i>
        <i class="toTop iconfont icon-fanhuidingbu">
            <div class="slogans">回到顶部
                <span class="trangle"></span>
            </div>
        </i>
    </div>
    <div class="fk-rbar-plugins">
        <div class="myStuffTab">
            <div class="myStuffTab_top">
                <div class="myStuffTab_top_l"><img src="image/secondbrand1.jpg" alt=""></div>
                <div class="myStuffTab_top_r">
                    <div>821998295</div>
                    <div>普通会员</div>
                </div>
            </div>
            <div class="myStuffTab_middle">
                <div>
                    <div>姓名</div>
                    <div>孙力1111</div>
                </div>
            </div>
            <div class="myStuffTab_middle">
                <div>
                    <div>邮箱</div>
                    <div>821992311@qq.com</div>
                </div>
            </div>
            <div class="myStuffTab_middle">
                <div>
                    <div>手机</div>
                    <div>13598745125</div>
                </div>
            </div>
            <div class="myStuffTab_bottom">退出登录</div>
        </div>
        <div class="myCollectionTab">
            <div></div>
            <div>亲，还没有入您法眼的商品哟~</div>
        </div>
        <div class="myCartTab">
            <div class="hasNoCartThings" style="display: none;">
                <div></div>
                <div>亲，您的购物车空空的哟~</div>
            </div>
            <div class="hasCartThings" style="display: block">
                <div class="hasCartThings_top">
                    <div class="cartThing">
                        <img src="image/111.jpg" class="cartThingImg">
                        <div class="cartThingTitle">8成新 新概念摄像机 高清专业数码摄像机</div>
                        <div class="cartThingPrice">￥11099</div>
                        <div class="cartThingNumber">x1</div>
                        <div class="cartThingDelete">删除</div>
                    </div>
                </div>
                <div class="hasCartThings_bottom">去购物车结算</div>
            </div>
        </div>
    </div>
</div>
<!--右侧导航栏结束-->
<!--main模块开始-->
<div class="main"></div>
<!--main模块结束-->
<!--body模块开始-->
<div class="body">
    <div class="w">
        <div class="body_top">
        </div>
        <div class="body_middle">
            <ul>
                <li>下一个：8成新 实木欧式宝宝床多功能摇篮床bb床新生儿拼接大床带蚊帐</li>
            </ul>
        </div>
        <div class="body_bottom">
            <div class="body_bottom_title">
                <div>产品详情</div>
            </div>
            <div class="body_bottom_des">
            </div>
        </div>
    </div>
</div>
<!--body模块结束-->
<!--foot模块开始-->
<div class="foot">
    <div class="foot_top"><img src="image/5XGBR@Z$QVQ4$%5D1K%60HRJ958.png" alt=""></div>
    <div class="foot_bottom"><img src="image/OP4FMG5S9X_6TVX%6034(PZC2.png" alt=""></div>
</div>
<!--foot模块结束-->
<!--遮挡层-->
<div class="barrier"></div>
<!--显示加入购物车成功-->
<div class="successToAddCart">
    <div class="successTitle">添加成功</div>
    <div class="cartDes">购物车共有3件商品。合计：￥57097</div>
    <div class="successBtn">
        <div class="gotoCart" id="gotoCart">去购物车结算</div>
        <a href="#">返回</a>
    </div>
    <span></span>
</div>
<script src="js/jquery-1.12.4.js"></script>
<script src="js/jquery.lazyload.js"></script>
<script src="js/template-web.js"></script>
<script src="js/jquery.cookie.js"></script>
<script src="js/base.js"></script>
<script src="js/shoppingDetail.js"></script>
<script>
    $(function () {
        var arr =
            '<table>' +
            '<tr>' +
            '<td>{{attributeName}}</td>' +
            '<td>{{attributeValue}}</td>' +
            '<td></td>' +
            '<td></td>' +
            '</tr>' +
            '</table>';

        var sdes =
            '<div class="smallImg">' +
            '<span class="slider"></span>' +
            '<img src="{{commodityPicture}}" alt="">' +
            '</div>' +
            '<div class="shoppingDes">' +
            '<div class="shoppingDesName">{{commodityTitle}}</div>' +
            '<div class="shoppingDesPrice">' +
            '<span>价格：</span>' +
            '<span>￥</span>' +
            '<span>{{commodityPrice}}.00</span>' +
            '</div>' +
            '<div class="shoppingDesNumber">' +
            '<span>购买数量：</span>' +
            '<input type="text" id="thingsNumber" value="1">' +
            '<span id="up"></span>' +
            ' <span id="down"></span>' +
            '<span>库存量:{{commodityInventory}}</span>' +
            '</div>' +
            '<div class="buyThings"><i class="iconfont icon-icon1"></i>加入购物车</div>' +
            '<div class="getInToCart" id="getInToCart">立即购买</div>' +
            '</div>' +
            '<div class="bigImg"><img src="{{commodityPicture}}" alt=""></div>';
        $.get("http://localhost:8080/commodity/detail", {"commodityId": sessionStorage.getItem("commodityId")}, function (res) {
            console.log(res);
            var render = template.compile(arr);
            var html = render(res.commodities);
            $(".body_bottom_des").html(html);
            var renders = template.compile(sdes);
            var htmls = renders(res.commodities);
            $(".body_top").html(htmls);
            var smallPic = $(".smallImg");
            // 获取大图容器
            var bigPic = $(".bigImg");
            // 获取滑块
            var slider = $(".slider");
            // 获取大图
            var bigImg = $(".bigImg>img");
            //移出
            smallPic.on("mouseleave", function () {
                slider.stop().hide();
                bigPic.stop().hide();
            });
            // 移入
            smallPic.on("mousemove", function (e) {
                slider.stop().show();
                bigPic.stop().show();
                var left = e.clientX - slider.width() / 2;
                // console.log(left);
                var top = e.clientY - slider.height() / 2;
                // console.log(slider.width());
                // 最大移动距离
                var x = left - 210;
                var y = top - 130;
                x = x < 0 ? 0 : x;
                x = x > smallPic.width() - slider.width() ? smallPic.width() - slider.width() : x;
                y = y < 0 ? 0 : y;
                y = y > smallPic.height() - slider.height() ? smallPic.height() - slider.height() : y;
                var percentX = (smallPic.width() - slider.width()) / (bigImg.width() - bigPic.width());
                var percentY = (smallPic.height() - slider.height()) / (bigImg.height() - bigPic.height());
                slider.css("left", x);
                slider.css("top", y);
                bigImg.css("marginLeft", -(x / percentX));
                bigImg.css("marginTop", -(y / percentY));
            });
            // 增加减少商品数
            $("#up").on("click", function () {
                clickchangeShoppingNumber($("#up"), $("#thingsNumber"), res.commodities.commodityInventory);
            });
            $("#down").on("click", function () {
                clickchangeShoppingNumber($("#down"), $("#thingsNumber"), res.commodities.commodityInventory);
            });
            $("#thingsNumber").on("keyup", function () {
                notClickchangeShoppingNumber($(this), res.commodities.commodityInventory);
            });
            //显示遮挡层和显示成功
            $(".buyThings").on("click", function () {
                if ($.cookie("userId") == undefined) {
                    sessionStorage.setItem("lastPage", "http://localhost:8080/commodity");
                    alert("请登录");
                    location.href = "http://localhost:8080/login";
                }
                if (res.commodities.commodityInventory == 0) {
                    alert("库存不足");
                }
                else {
                    $(".barrier").stop().show();
                    $(".successToAddCart").stop().show();
                }
            });
            //去掉遮挡层和显示成功
            $(".successBtn>a,.successToAddCart>span").on("click", function () {
                $(".barrier").stop().hide();
                $(".successToAddCart").stop().hide();
                return false;
            });
            //跳转到购物车
            $("#gotoCart").on("click", function () {
                location.href = "http://localhost:8080/shoppingcart";
            });
            //立即购买
            $("#getInToCart").on("click", function () {
                if ($.cookie("userId") == undefined) {
                    sessionStorage.setItem("lastPage", "http://localhost:8080/commodity");
                    alert("请登录");
                    location.href = "http://localhost:8080/login";
                } else if (res.commodities.commodityInventory == 0) {
                    alert("库存不足");
                } else {
                    var thingsNumber = $("#thingsNumber").val();
                    sessionStorage.setItem("thingsNumber", thingsNumber);
                    location.href = "http://localhost:8080/order";
                }
            });
        });

        //按钮点击调节商品数量
        function clickchangeShoppingNumber(clickElement, changeElement, maxValue) {
            var thingsNumber = changeElement.val();
            if (clickElement.attr("id") == "up") {
                thingsNumber++;
            }
            else {
                thingsNumber--;
            }
            if (thingsNumber <= 1) {
                thingsNumber = 1;
                $("#up").css("backgroundPosition", "-625px -974px");
                $("#down").css("backgroundPosition", "-591px -1005px");
            }
            else if (thingsNumber >= maxValue) {
                thingsNumber = maxValue;
                $("#up").css("backgroundPosition", "-591px -974px");
                $("#down").css("backgroundPosition", "-625px -1005px");
            }
            else {
                $("#down").css("backgroundPosition", "-625px -1005px");
                $("#up").css("backgroundPosition", "-625px -974px");
            }
            changeElement.val(thingsNumber);
        }

        // 不是按钮点击操作商品数量
        function notClickchangeShoppingNumber(changeElement, maxValue) {
            var thingsNumber = changeElement.val();
            if (thingsNumber <= 1) {
                $("#up").css("backgroundPosition", "-625px -974px");
                $("#down").css("backgroundPosition", "-591px -1005px");
            }
            else if (thingsNumber >= maxValue) {
                $("#up").css("backgroundPosition", "-591px -974px");
                $("#down").css("backgroundPosition", "-625px -1005px");
            }
            else {
                $("#down").css("backgroundPosition", "-625px -1005px");
                $("#up").css("backgroundPosition", "-625px -974px");
            }
        }
    });
</script>
</body>
</html>